
int main(void)
{
  clock_t startSD, endSD, startTot, endTot, startMorpho, endMorpho;
  double cpuTimeSD = 0.0;
  double cpuTimeTot = 0.0;
  double cpuTimeMorpho = 0.0;
  long nrl, nrh, ncl, nch;
  int dim = 3;
  char filename0[255];
  char filename1[255];
  char filenameE[255];
  char filenameO[255];
  uint8** I0;
  uint8** I1;
  uint8** M0 = LoadPGM_ui8matrix("../hall/hall000000.pgm",&nrl,&nrh,&ncl,&nch);
  uint8** O1 = ui8matrix(nrl, nrh, ncl, nch);
  uint8** E1 = ui8matrix(nrl, nrh, ncl, nch);
  uint8** M1 = ui8matrix(nrl, nrh, ncl, nch);
  uint8** V0 = ui8matrix(nrl, nrh, ncl, nch);
  uint8** V1 = ui8matrix(nrl, nrh, ncl, nch);
  
  for(int i = 0; i < NIMAGES - 1; i++)
    {
      sprintf(filename0,"../hall/hall%06d.pgm",i);
      sprintf(filename1,"../hall/hall%06d.pgm",i+1);
      I0 = LoadPGM_ui8matrix(filename0, &nrl, &nrh, &ncl, &nch);
      I1 = LoadPGM_ui8matrix(filename1, &nrl, &nrh, &ncl, &nch);

      startTot = clock();
      startSD = clock();
      sigmaDelta(I0, I1, M0, M1, V0, V1, O1, E1, nrl, nrh, ncl, nch);
      endSD = clock();
      cpuTimeSD += ((double) (endSD-startSD))/ CLOCKS_PER_SEC * 1000;
      
      startMorpho = clock();
      E1 = ouverture(E1, nrl, nrh, ncl, nch, dim);
      E1 = fermeture(E1, nrl, nrh, ncl, nch, dim);
      E1 = ouverture(E1, nrl, nrh, ncl, nch, 5);
      E1 = fermeture(E1, nrl, nrh, ncl, nch, 5);
      endMorpho = clock();
      endTot = clock();
      cpuTimeMorpho += ((double) (endMorpho-startMorpho))/CLOCKS_PER_SEC * 1000;
      cpuTimeTot += ((double) (endTot-startTot))/CLOCKS_PER_SEC * 1000;
      
      sprintf(filenameO,"../output/hallScalar/SDO/hall%06dO.pgm",i);
      sprintf(filenameE,"../output/hallScalar/SDE/hall%06dE.pgm",i+1);
      
      SavePGM_ui8matrix(O1, nrl, nrh, ncl, nch, filenameO);
      SavePGM_ui8matrix(E1, nrl, nrh, ncl, nch, filenameE);

      copy_ui8matrix_ui8matrix (V1, nrl, nrh, ncl, nch, V0);
      copy_ui8matrix_ui8matrix (M1, nrl, nrh, ncl, nch, M0);
    }
  printf("Temps passé dans l'algo SD : %f ms\n", cpuTimeSD);
  printf("Temps passé dans les algos de morphologies : %f ms\n", cpuTimeMorpho);
  printf("Temps total : %f ms\n", cpuTimeTot);
}
